<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PICO IOT - Profile & Settings</title>
    <script src="../theme-loader.js"></script>
    <link rel="stylesheet" href="profile.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚙️</text></svg>">
</head>
<body>
    <header class="app-header">
        <div class="header-content">
            <a href="../dashboard.html" class="back-button">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
            </a>
            <h1 class="app-title">Settings</h1>
            <div class="header-placeholder"></div>
        </div>
    </header>

    <main class="main-content">
        <div class="profile-header">
            <div class="profile-avatar">
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
            </div>
            <div class="profile-info">
                <div class="name-container">
                    <h2 id="user-name-display">Loading...</h2>
                    <button id="edit-name-btn" class="inline-edit-btn" aria-label="Edit Name">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path></svg>
                    </button>
                </div>
                <p id="user-email-display">Loading...</p>
            </div>
        </div>

        <div class="settings-section">
            <h3 class="section-title">My Profile</h3>
            <div class="settings-list">
                <!-- MODIFIED: Added id to open the family modal -->
                <a href="#" id="family-members-btn" class="list-item">
                    <span>Family Members</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
                </a>
            </div>
        </div>

        <div class="settings-section">
            <h3 class="section-title">Appearance</h3>
            <div id="theme-selector" class="theme-selector-container">
                <button class="theme-btn" data-theme="dark"><div class="theme-preview theme-dark"></div><span>Dark</span></button>
                <button class="theme-btn" data-theme="light"><div class="theme-preview theme-light"></div><span>Light</span></button>
                <button class="theme-btn" data-theme="twilight"><div class="theme-preview theme-twilight"></div><span>Twilight</span></button>
                <button class="theme-btn" data-theme="ocean"><div class="theme-preview theme-ocean"></div><span>Ocean</span></button>
                <button class="theme-btn" data-theme="forest"><div class="theme-preview theme-forest"></div><span>Forest</span></button>
                <button class="theme-btn" data-theme="sunrise"><div class="theme-preview theme-sunrise"></div><span>Sunrise</span></button>
                <button class="theme-btn" data-theme="matrix"><div class="theme-preview theme-matrix"></div><span>Matrix</span></button>
            </div>
        </div>

        <div class="settings-section">
            <h3 class="section-title">About & Support</h3>
            <div class="settings-list">
                <a href="#" class="list-item"><span>Support Hub</span><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg></a>
                <a href="#" class="list-item"><span>About PICO IOT</span><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg></a>
            </div>
        </div>

        <div class="logout-section">
            <button id="logout-btn" class="logout-button">Logout</button>
        </div>
    </main>
    
    <!-- Edit Name Modal -->
    <div id="edit-name-modal" class="modal-overlay">
        <div class="modal-content">
            <button class="close-modal-btn" aria-label="Close">&times;</button>
            <h2>Edit Your Name</h2>
            <form id="edit-name-form">
                <div class="input-group"><label for="new-name-input">Your Name</label><input type="text" id="new-name-input" placeholder="Enter your new name" required></div>
                <button type="submit" class="modal-button">Save Changes</button>
            </form>
        </div>
    </div>

    <!-- NEW: Family Members Modal -->
    <div id="family-modal" class="modal-overlay">
        <div class="modal-content">
            <button class="close-modal-btn" aria-label="Close">&times;</button>
            <h2>Family Members</h2>
            <p>Select who is using the app. Add or remove members who share this home.</p>
            
            <div id="family-list" class="family-list">
                <!-- Family members will be dynamically inserted here -->
            </div>

            <form id="add-member-form" class="add-member-form">
                <input type="text" id="new-member-name" placeholder="New member's name" required>
                <button type="submit" class="add-member-btn">Add</button>
            </form>
        </div>
    </div>

    <script src="profile.js" type="module"></script>
</body>
</html>
